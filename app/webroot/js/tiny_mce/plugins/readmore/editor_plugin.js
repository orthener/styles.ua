(function(){tinymce.create("tinymce.plugins.ReadMorePlugin",{init:function(b,d){var f='<img src="'+d+'/img/trans.gif" class="mceReadMore mceItemNoResize" />',a="mceReadMore",c=b.getParam("readmore_separator","<!-- readmore -->"),e;e=new RegExp(c.replace(/[\?\.\*\[\]\(\)\{\}\+\^\$\:]/g,function(g){return"\\"+g}),"g");b.addCommand("mceReadMore",function(){b.execCommand("mceInsertContent",0,f)});b.addButton("readmore",{title:"readmore.desc",cmd:a});b.onInit.add(function(){if(b.settings.content_css!==false){b.dom.loadCSS(d+"/css/content.css")}if(b.theme.onResolveName){b.theme.onResolveName.add(function(g,h){if(h.node.nodeName=="IMG"&&b.dom.hasClass(h.node,a)){h.name="readmore"}})}});b.onClick.add(function(g,h){h=h.target;if(h.nodeName==="IMG"&&g.dom.hasClass(h,a)){g.selection.select(h)}});b.onNodeChange.add(function(h,g,i){g.setActive("readmore",i.nodeName==="IMG"&&h.dom.hasClass(i,a))});b.onBeforeSetContent.add(function(g,h){h.content=h.content.replace(e,f)});b.onPostProcess.add(function(g,h){if(h.get){h.content=h.content.replace(/<img[^>]+>/g,function(i){if(i.indexOf('class="mceReadMore')!==-1){i=c}return i})}})},getInfo:function(){return{longname:"ReadMore",author:"Moxiecode Systems AB",authorurl:"http://tinymce.moxiecode.com",infourl:"http://wiki.moxiecode.com/index.php/TinyMCE:Plugins/readmore",version:tinymce.majorVersion+"."+tinymce.minorVersion}}});tinymce.PluginManager.add("readmore",tinymce.plugins.ReadMorePlugin)})();